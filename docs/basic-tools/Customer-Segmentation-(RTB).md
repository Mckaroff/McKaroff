---
icon: fontawesome/solid/puzzle-piece
tags:
  - Analytics
---
# Сегментация клиентов (RTB)

## Введение

Потребительское поведение, как часть поведения человека в целом, можно определить как взаимосвязь разнообразных контекстов (привычки, знания, культура, половые различия) и триггеров, неких спусковых крючков для последующего, часто шаблонного, действия или реакции.  

Когда речь об исторических данных продаж в разрезе каждого клиента имеет смысл "нарезать" эту базу по потребительскому профилю в отношении продуктов и компании в целом.

Сейчас мы не будем рассматривать движение еще потенциального покупателя, а рассмотрим один из популярных инструментов в сегментации именно вчерашних потребителей, что будет ценно, если ваша компания нацелена на повторяемость продаж одному и тому же клиенту или у вас есть неплохой набор комплиментарных товаров.

!!! note ""

## Что мы можем узнать, исследуя CRM базу?

#### Время и давность

Одна когорта клиентов покупала у нас что-то давно, другие совсем недавно, кто-то покупал в сезон, а кто-то на скидках после сезона. По одной-двум продажам мы не можем судить о детерминированности поведения, но это уже кое-что. Кроме того, мы можем прикинуть среднюю длинную жизненного цикла клиента (от первой до последней покупки).

#### Деньги

Если ваша продуктовая сетка достаточно широка и часть продуктов выполняет одинаковые функции, то средний чек внутри категории для повторяемой продажи клиенту отражает его покупательскую способность в отношении этой продукции.

#### Количество чеков

Если структура предложения достаточно широкая, а клиентская база велика - мы увидим обычную Гауссову кривую с большим основанием из единичных покупок и несколькими аномальными всплесками, когда какой-нибудь офис-менеджер забыл купить необходимое у оптовой компании и заказал махом в рознице стулья на весь новый офис.

#### Продукты

Самый прозрачный поведенческий фактор - продукт. Мы имеем дело с состоявшимся потребительским поведением. Тут то обычно и начинаются игры с "апсейлом", "прогревом" на следующую покупку итд.

## Суть RFM

Идея RFM анализа заманчива и проста: мы делим клиентов на сегменты, опираясь на несколько показателей:

* R (recency - давность покупки)
* F (frequency - частота покупок)
* M (monetary - сумма трат клиента)

Я рекомендую сразу же обогатить поле исследуемых данных несколькими значениями:

* продукт и/или категория продукта
* источник клиента (это может быть источник для первой или для последней продажи в зависимости от целей и доступности данных)
* Что-то специфичное для вашего бизнеса: модель оплаты, готовность приехать на встречу или логистика.

#### Графический метод

Используя в таком случае всю модель данных о продажах, мы можем получить сегменты. В моем примере их 4 на каждый параметр.

##### Давность:
R1 - самые давние, возможно, первые продажи компании
R4 - недавний сезонный всплеск

![[../media/RFM/RFM - R.png]]
##### Частота:
F1 - всего несколько продаж
F4 - фанаты
![[RFM - F.png]]
##### Денежность:
M1 - принесли компании пока мало
М4 - принесли сильно больше среднего
![[RFM - M.png]]

Обобщение: комбинируя сегменты мы можем получить, к примеру сегмент R2F3F4 (клиенты, которые раньше покупали часто и принесли неплохие деньги, но перестали приобретать у нас) - отсюда и следует вся цепочка возможных гипотез и действий, направленных как на свою компанию, так и на дальнейшие коммуникации с клиентом.

## Приступим к практике
Ниже я приведу последовательность действий на основе простой таблицы позволяющей сегментировать клиентов.

##### Загрузка данных
` Лист: Продажи (source)`

| Клиентские данные | Продажи            |
|:----------------- |:------------------ |
| ID Клиента (!)    | Продукт            |
| ФИО               | Категория продукта |
| Почта             | Стоимость (!)      |
| Телефон           | Дата (!)           |
| Источник          | Источник заявки    |
| Доп инф.          | Продавец           |
|                   | Доп инф.           |

Лист имеет две секции:
1. стандартные данные о клиентах: (обязательное поле только ID, для дальнейшего удобства лучше взять из CRM, но можно любые уникальные значения)
2. Данные о продажах: (обязательные поля: стоимость и дата)

##### Настройка диапазонов
` Лист: Настройка сегментов`

На нем рассчитываются несколько вспомогательных значений, использование их или поиск своего аналитического способа остается на ваше усмотрение, но важно помнить, что сегменты должны иметь смысл для дальнейшего использования.

| Для всей базы                    | Для клиентов                                  |
|:-------------------------------- |:--------------------------------------------- |
| Всего чеков                      | Максимальное число чеков                      |
| Вся выручка                      | Среднее число чеков                           |
| Средний чек                      | Медианное число чеков                         |
| Медианный размер чека             | Максимальная продолжительность<br>жизни (дни) |
| Среднеквадратичное отклонение     | Максимальная выручка с клиента                |
| Максимальный чек                 | Медианная выручка с клиента                   |
| Минимальный чек                  | Средний чек                                   |
| День первой продажи              | Медианный чек                                 |
| День последней продажи           |                                               |
| Финансовая жизнь компании (дней) |                                               |

Вот так это выглядит в таблице:
![[RFM -SET.png]]


Графики для визуального контроля наполняемости сегментов:
![[RFM -SET - GRAPH.png]]

##### Получение результатов
` Лист: Клиенты (out)`

Теперь для конкретных клиентов появилось несколько дополнительных значений:

| Столбцы | Комментарий |
| :--- | ---- |
| Выручка | Выручка на клиента <br>за весь срок жизни |
| Кол-во  <br>чеков |  |
| Дата последнего чека |  |
| Дата первого чека |  |
| Срок жизни  <br>/ (дни) | От первой покупки <br>до последней в днях |
| Давность  <br>/ (дни) | От последней покупки<br>до сегодняшнего дня в днях |
| Минимальный чек |  |
| Максимальный чек |  |
| Средний чек |  |
| Давность последнего чека (сегмент) | Сегменты R1-R4 |
| Частота (кол-во чеков, сегмент) | Сегменты F1-F4 |
| Средний чек (сегмент) | Сегменты M1-M4 |

##### Фильтрация и получение смешанных сегментов
` Лист: Выходная база для фильтрации (out)`

Чтобы не попортить формулы, я вывел ссылки на данные из листа `Клиенты (out)` на отдельный лист. Если вы не использовали google таблицы ранее, то необходимо выделить все данные на листе, зайти в ` данные` ->` создать фильтр`  и отфильтровать нужные вам наборы сегментов.

## Модели использования

1. У вас сезонный бизнес? ` Давность`  + ` категория товара` соберет в одну базу всех, кто покупал перед прошлым сезоном и может купить снова
2. Обновляете систему лояльности? Начните ее проверять на тех, кто с вами давно, недавно покупал на хорошие суммы, а последнее время как то потерялся ` давность`  + ` средний чек`  + ` время жизни`
3. Есть желание заработать на апсейле за счет аксессуаров и доп.опций? Отлично: ` Категория товара` +` средний чек` +` частота`, вероятно, это те кто вам нужен.

## Забрать шаблон
[Забрать шаблон RFM-сегментации в google sheets](https://docs.google.com/spreadsheets/d/1k-Oa8Y-bVNfupdKH4FL89p--jwohFZ1Lwli0x1E4ozY/edit?usp=sharing)

---

## P.S
Датасет с клиентскими данными в шаблоне сгенерирован с использованием ИИ на основе реальных данных магазина. Все совпадения с реальными адресами, именами или телефонами случайны.
